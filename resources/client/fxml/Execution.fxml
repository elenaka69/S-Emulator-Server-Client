<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>

<BorderPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="client.ExecutionController"
            stylesheets="@/client/css/style.css"
            styleClass="root">

    <!-- Top: App title -->
    <top>
        <VBox spacing="10" alignment="TOP_CENTER" style="-fx-padding: 10;" fillWidth="true">
            <Label text="S-Emulator - Execution" styleClass="title"/>

        <!-- Username (aligned left) -->
            <HBox alignment="CENTER_LEFT" style="-fx-padding: 0 0 0 10;" fillHeight="true">
                <Label fx:id="usernameField" text="" styleClass="section-label"/>
                <Region HBox.hgrow="ALWAYS"/>

                <!-- Available Credits -->
                <Label text="Available Credits:  "/>
                <TextField fx:id="creditsField" prefWidth="80" editable="false"/>
            </HBox>
            <HBox alignment="CENTER_LEFT" style="-fx-padding: 0 0 0 0;">
                <Region HBox.hgrow="ALWAYS"/>
                <Button fx:id="chatButton" text="Chat" onAction="#onToggleChat"/>
            </HBox>
        </VBox>
    </top>

    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true" style="-fx-padding: 0 10 10 0;">
            <content>
                <VBox spacing="10" alignment="TOP_CENTER">
                    <HBox fx:id="executionMainContentBox" spacing="10" alignment="TOP_LEFT"
                          style="-fx-padding: 0 0 0 20;" HBox.hgrow="ALWAYS">

                        <!-- Instructions Module -->
                        <TitledPane text="Instructions" collapsible="false" prefWidth="460">
                            <VBox spacing="10" alignment="TOP_CENTER" fillWidth="true" style="-fx-padding: 10;">
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <Label fx:id="expandLabel" text="Range Degrees"/>
                                    <TextField fx:id="expandField" promptText="0" editable="false" prefWidth="50"/>
                                    <Button text="Expand" fx:id="expandButton" onAction="#onExpand"/>
                                    <Button text="Collapse" fx:id="collapseButton" onAction="#onCollapse"/>
                                </HBox>

                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <ComboBox fx:id="funcsComboBox" prefWidth="150" editable="true" promptText="Function Selector"/>
                                    <ComboBox fx:id="highlightComboBox" prefWidth="150" editable="true" promptText="Highlight selection"/>
                                </HBox>

                                <Label text="Program Instructions:" styleClass="section-label" alignment="TOP_CENTER"/>
                                <TableView fx:id="instructionTable" prefHeight="200" prefWidth="480"
                                           style="-fx-border-color: gray; -fx-border-width: 2; -fx-border-radius: 5;">
                                    <columns>
                                        <TableColumn text="bp" prefWidth="30" fx:id="colBreakpoint"/>
                                        <TableColumn text="#" prefWidth="30" fx:id="colNumber"/>
                                        <TableColumn text="Type" prefWidth="55" fx:id="colType"/>
                                        <TableColumn text="Arch" prefWidth="50" fx:id="colArch"/>
                                        <TableColumn text="Label" prefWidth="50" fx:id="colLabel"/>
                                        <TableColumn text="Instruction" prefWidth="170" fx:id="colInstruction"/>
                                        <TableColumn text="Cycle" prefWidth="50" fx:id="colCycle"/>
                                    </columns>
                                </TableView>

                                <Label text="Instruction history chain:" styleClass="section-label" alignment="TOP_CENTER"/>
                                <TableView fx:id="historyInstrTable" prefHeight="150" prefWidth="480"
                                           style="-fx-border-color: gray; -fx-border-width: 2; -fx-border-radius: 5;">
                                    <columns>
                                        <TableColumn text="#" prefWidth="40" fx:id="colHistoryNumber"/>
                                        <TableColumn text="Type" prefWidth="60" fx:id="colHistoryType"/>
                                        <TableColumn text="Arch" prefWidth="60" fx:id="colHistoryArch"/>
                                        <TableColumn text="Label" prefWidth="60" fx:id="colHistoryLabel"/>
                                        <TableColumn text="Instruction" prefWidth="160" fx:id="colHistoryInstruction"/>
                                        <TableColumn text="Cycle" prefWidth="50" fx:id="colHistoryCycle"/>
                                    </columns>
                                </TableView>
                            </VBox>
                        </TitledPane>

                        <!-- Run-Debug Module -->
                        <TitledPane text="Run-Debug" collapsible="false" prefWidth="450">
                            <VBox fx:id="runBox" spacing="10" alignment="TOP_CENTER" fillWidth="true" style="-fx-padding: 10;">
                                <HBox fx:id="runButtonsBox" spacing="10" alignment="TOP_LEFT" style="-fx-padding: 0 0 0 10;">
                                    <Button fx:id="runButton" text="Run" onAction="#onRun" contentDisplay="LEFT">
                                        <graphic>
                                            <ImageView fitWidth="16" fitHeight="16">
                                                <image>
                                                    <Image url="@/client/icons/play.png"/>
                                                </image>
                                            </ImageView>
                                        </graphic>
                                    </Button>
                                    <Button fx:id="debugButton" text="Debug" onAction="#onDebug" contentDisplay="LEFT">
                                        <graphic>
                                            <ImageView fitWidth="16" fitHeight="16">
                                                <image>
                                                    <Image url="@/client/icons/debug.png"/>
                                                </image>
                                            </ImageView>
                                        </graphic>
                                    </Button>
                                </HBox>

                                <Label text="Debug:" styleClass="section-label" alignment="TOP_CENTER"/>
                                <HBox fx:id="debugButtonsBox" spacing="10" alignment="TOP_LEFT" prefWidth="400">
                                    <Button fx:id="stopButton"
                                            onAction="#onStopDebug"
                                            disable="true"
                                            contentDisplay="LEFT" HBox.hgrow="ALWAYS" maxWidth="Infinity" >
                                        <graphic>
                                            <ImageView fitWidth="16" fitHeight="16">
                                                <image>
                                                    <Image url="@/client/icons/stop.png" />
                                                </image>
                                            </ImageView>
                                        </graphic>
                                    </Button>
                                    <Button fx:id="resumeButton"
                                            onAction="#onResumeDebug"
                                            disable="true"
                                            contentDisplay="LEFT" HBox.hgrow="ALWAYS" maxWidth="Infinity" >
                                        <graphic>
                                            <ImageView fitWidth="16" fitHeight="16">
                                                <image>
                                                    <Image url="@/client/icons/resume.png" />
                                                </image>
                                            </ImageView>
                                        </graphic>
                                    </Button>
                                    <Button fx:id="stepOverButton"
                                            onAction="#onStepOver"
                                            disable="true"
                                            contentDisplay="LEFT" HBox.hgrow="ALWAYS" maxWidth="Infinity" >
                                        <graphic>
                                            <ImageView fitWidth="16" fitHeight="16">
                                                <image>
                                                    <Image url="@/client/icons/step_over.png" />
                                                </image>
                                            </ImageView>
                                        </graphic>
                                    </Button>
                                    <Button fx:id="stepBackButton"
                                            onAction="#onStepBackButton"
                                            disable="true"
                                            contentDisplay="LEFT" HBox.hgrow="ALWAYS" maxWidth="Infinity" >
                                        <graphic>
                                            <ImageView fitWidth="16" fitHeight="16">
                                                <image>
                                                    <Image url="@/client/icons/step_back.png" />
                                                </image>
                                            </ImageView>
                                        </graphic>
                                    </Button>
                                </HBox>
                                <TableView fx:id="debugTable" prefHeight="200" prefWidth="500"
                                           style="-fx-border-color: gray; -fx-border-width: 2; -fx-border-radius: 5;">
                                    <columns>
                                        <TableColumn text="Variable" prefWidth="200" fx:id="colVar"/>
                                        <TableColumn text="Value" prefWidth="240" fx:id="colValue"/>
                                    </columns>
                                </TableView>

                                <Label text="Program's History:" styleClass="section-label" alignment="TOP_CENTER"/>
                                <TableView fx:id="historyRunTable" prefHeight="180" prefWidth="500"
                                           style="-fx-border-color: gray; -fx-border-width: 2; -fx-border-radius: 5;">
                                    <columns>
                                        <TableColumn text="#" prefWidth="40" fx:id="colHistoryRunNumber"/>
                                        <TableColumn text="Degree" prefWidth="50" fx:id="colHistoryRunDegree"/>
                                        <TableColumn text="Input" prefWidth="170" fx:id="colHistoryRunInput"/>
                                        <TableColumn text="Result" prefWidth="90" fx:id="colHistoryRunResult"/>
                                        <TableColumn text="Cycle" prefWidth="70" fx:id="colHistoryRunCycle"/>
                                    </columns>
                                </TableView>
                            </VBox>
                        </TitledPane>

                        <!-- Chat Pane -->
                        <TitledPane fx:id="chatPane" text="Chat" collapsible="false" prefWidth="400"
                                    visible="false" managed="false">
                            <VBox spacing="10" alignment="TOP_CENTER" fillWidth="true" style="-fx-padding: 10;">
                                <ScrollPane fx:id="chatScrollPane" fitToWidth="true" prefHeight="300" prefWidth="400">
                                    <content>
                                        <VBox fx:id="chatBox" spacing="5" alignment="TOP_CENTER" style="-fx-padding: 10;"/>
                                    </content>
                                </ScrollPane>
                                <HBox spacing="5">
                                    <TextField fx:id="chatInput" promptText="Type your message..." HBox.hgrow="ALWAYS"/>
                                    <Button text="Send" onAction="#onSendMessage"/>
                                </HBox>
                            </VBox>
                        </TitledPane>
                    </HBox>

                    <HBox alignment="CENTER_RIGHT" style="-fx-padding: 10 20 10 20;">
                        <Button text="Back to Dashboard" fx:id="backToDashboard" onAction="#onBackToDashboard"/>
                    </HBox>
                </VBox>
            </content>
        </ScrollPane>
    </center>


    <!-- Bottom: Status bar -->
    <bottom>
        <Label fx:id="statusBar" text="Ready." styleClass="section-label" style="-fx-padding:10; "/>
    </bottom>

</BorderPane>
